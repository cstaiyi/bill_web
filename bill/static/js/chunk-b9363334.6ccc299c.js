(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b9363334"],{"15c6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"view-archives-archivesIndex"},[a("Button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:t.addClick}},[t._v("新增一级消费类型")]),a("Table",{attrs:{loading:t.loading,border:"",columns:t.tbColumns,data:t.tbData}}),a("Row",[a("Col",{attrs:{span:"24"}},[a("div",{staticClass:"page"},[a("Page",{attrs:{total:t.total,current:t.pageParams.current,"page-size":t.pageParams.size,"show-total":""},on:{"on-change":t.onChange}})],1)])],1)],1),a("Modal",{attrs:{title:"一级消费类型"},on:{"on-ok":function(e){return t.ok("refVallidate")},"on-cancel":function(e){return t.cancel("refVallidate")}},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[a("div",{staticClass:"form"},[a("i-form",{ref:"refVallidate",attrs:{model:t.formValidate,"label-width":150}},[a("Form-item",{attrs:{label:"一级消费类型名称：",prop:""}},[a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"例如：生活缴费"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1),a("Form-item",{attrs:{label:"二级消费类型名称：",prop:""}},[a("Input",{staticStyle:{width:"135px"},attrs:{placeholder:"例如：水费"},model:{value:t.secondName,callback:function(e){t.secondName=e},expression:"secondName"}}),a("i-button",{staticStyle:{"margin-left":"7px"},attrs:{icon:"ios-plus-empty",type:"dashed"},on:{click:t.addSecondClick}},[t._v("添加  ")])],1),null!=t.secondList?a("Form-item",{staticStyle:{"margin-left":"-120px"},attrs:{label:"",prop:""}},t._l(t.secondList,function(e){return a("Tag",{attrs:{type:"dot",closable:"",color:"blue"},on:{"on-close":function(a){return t.secondClose(e.name)}}},[t._v(t._s(e.name))])}),1):t._e(),null==t.secondList[0]?a("Form-item",{attrs:{label:"请注意：",prop:""}},[a("span",[t._v("至少要添加一个二级消费类型")])]):t._e()],1)],1)])],1)},s=[],n=(a("7f7f"),{name:"archivesIndex",components:{},data:function(){var t=this;this.$createElement;return{pageParams:{current:1,size:10,registerId:""},total:0,secondList:[],detailId:"",editFlag:1,addShow:!1,detailShow:!1,loading:!1,modal1:!1,secondName:"",formValidate:{id:"",name:"",registerId:"",secondList:[]},tbColumns:[{title:"一级消费类型名称",key:"name",width:400},{title:"创建时间",key:"createTime",minWidth:400},{title:"操作",key:"action",width:300,fixed:"right",align:"center",render:function(e,a){return e("div",[e("i-button",{attrs:{type:"warning",size:"small"},on:{click:function(){t.updateClick(a.row)}}},["修改"]),"  ",e("i-button",{attrs:{type:"error",size:"small"},on:{click:function(){t.deleteClick(a.row)}}},["删除"])])}}],tbData:[]}},mounted:function(){var t=window.localStorage.getItem("userInfo");this.userInfo=JSON.parse(t),this.queryData()},methods:{queryData:function(){var t=this;this.pageParams.registerId=this.userInfo.id,this.$axios.request({url:this.$api.consumption.pageFirstConsumption,params:this.pageParams,method:"get"}).then(function(e){if(200===e.data.code){t.total=e.data.total,t.tbData=e.data.data;var a=window.localStorage.getItem("userInfo");JSON.parse(a)}else t.$Message.warning(e.data.message);t.loading=!1})},addClick:function(){this.secondName="",this.secondList=[],this.editFlag=1,this.modal1=!0},addSecondClick:function(){var t=0;if(null==this.secondName||""==this.secondName.trim())t=2;else for(var e=0;e<this.secondList.length;e++)if(this.secondList[e].name==this.secondName.trim()){t=1;break}if(1!=t)if(2!=t){var a={name:this.secondName.trim()};this.secondList.push(a),this.secondName=""}else this.$Message.warning("二级消费类型名称不能为空");else this.$Message.warning("二级消费类型名称不能重复")},secondClose:function(t){var e=this;1==this.editFlag?this.closeFunc(t):2==this.editFlag&&this.$Modal.confirm({title:"删除",content:"<h4>删除后相关联流水记录的二级消费类型也会消失，仍然删除？</h4>",onOk:function(){e.closeFunc(t)}})},closeFunc:function(t){for(var e=0;e<this.secondList.length;e++)if(this.secondList[e].name==t){this.secondList.splice(e,1);break}},updateClick:function(t){var e=this;this.formValidate.id=t.id,this.formValidate.name=t.name,this.editFlag=2,this.modal1=!0,this.$axios.request({url:this.$api.consumption.findSecondDetail,params:{id:t.id},method:"get"}).then(function(t){200===t.data.code?e.secondList=t.data.data:e.$Message.warning(t.data.message),e.loading=!1})},onChange:function(t){this.pageParams.current=t,this.queryData()},deleteClick:function(t){var e=this;this.$Modal.confirm({title:"删除",content:"<h4>删除后相关联流水记录的消费类型也会消失，仍然删除？</h4>",onOk:function(){e.$axios.request({url:e.$api.consumption.delete,data:t,method:"post"}).then(function(t){200===t.data.code?(e.queryData(),e.$Message.success(t.data.message)):e.$Message.warning(t.data.message)})}})},ok:function(){var t=this;0!=this.secondList.length?(this.formValidate.registerId=this.userInfo.id,this.formValidate.secondList=this.secondList,this.$axios.request({url:this.$api.consumption.addOrUpdate,data:this.formValidate,method:"post"}).then(function(e){200===e.data.code?(t.modal1=!1,t.queryData(),t.$Message.success(e.data.message),t.formValidate={}):t.$Message.warning(e.data.message)})):this.$Message.warning("至少要添加一个二级消费类型")},cancel:function(){this.modal1=!1,this.formValidate={}}}}),o=n,r=(a("d871"),a("2877")),d=Object(r["a"])(o,i,s,!1,null,null,null);e["default"]=d.exports},d6a1:function(t,e,a){},d871:function(t,e,a){"use strict";var i=a("d6a1"),s=a.n(i);s.a}}]);